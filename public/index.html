<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title>Find Identification Resources - Library of Identification Resources</title>

        <link rel="stylesheet" href="/assets/css/main.css">
        <link rel="stylesheet" href="main.css">
        <link rel="shortcut icon" href="/assets/img/logo_124.png">

        <meta name="viewport" content="width=device-width, initial-scale=1">

        <script>window.goatcounter={path:p=>location.host+p}</script>
        <script data-goatcounter="https://larsgw.goatcounter.com/count" async src="//gc.zgo.at/count.v4.js" crossorigin="anonymous" integrity="sha384-nRw6qfbWyJha9LhsOtSb2YJDyZdKvvCFh0fJYlkquSFjUxp9FVNugbfy8q1jdxI+"></script>
    </head>
    <body>
        <header class="small">
            <a href="..">
                <img id="logo" src="/assets/img/logo_512.png" alt="Logo: moth with spread, speckled black and red wings">
            </a>

            <h1>Library of Identification Resources</h1>

            <nav role="navigation" aria-label="Site Navigation">
                <ul>
                    <li><a href="/catalog">Catalog</a></li>
                    <li><a href="/catalog/visualizations">Statistics</a></li>
                    <li><a href="https://github.com/identification-resources">GitHub</a></li>
                </ul>
            </nav>
        </header>

        <main>
            <div id="input_wrapper">
                <h2>Find identification resources</h2>

                <form action="#results_wrapper">
                    <fieldset>
                        <legend>Usage</legend>
                        <p>
                            Select an organism that you want to identify. In the left field labeled "Taxon", search
                            and select the scientific name of the group of species that you know it is part of. In
                            the right field, search for the region or paste coordinates (formatted like: "0.000, 0.000")
                            to the location where you found the organism.
                        </p>

                        <div style="display: flex; gap: 2em; margin-bottom: 1em;">
                            <div id="group_taxon" style="flex-grow: 1;"></div>
                            <div id="group_location" style="flex-grow: 1;"></div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend>Checklists</legend>
                        <p>
                            To calculate whether an identification resource is suitable for the given location, a
                            checklist is used and compared against the list of species included in the key. This
                            checklist can either be generated from GBIF occurrences, in which case the list consists
                            of all species in the given country with occurrences in GBIF. Alternatively, a resource
                            from the catalog can be used to compare against.
                        </p>

                        <input type="radio" name="checklist" value="search" checked id="checklist_search">
                        <label for="checklist_search">Checklist generated from GBIF occurrences</label>

                        <br>

                        <input type="radio" name="checklist" value="gbif_dataset" id="checklist_gbif_dataset">
                        <label for="checklist_gbif_dataset">Checklist from GBIF dataset</label>
                        <div id="group_checklist-gbif-dataset" style="margin-left: 25px;"></div>

                        <br>

                        <input type="radio" name="checklist" value="catalog" id="checklist_catalog">
                        <label for="checklist_catalog">Checklist from the catalog</label>
                        <div id="group_checklist-catalog" style="margin-left: 25px;"></div>
                    </fieldset>

                    <fieldset>
                        <legend>Filters</legend>
                        <p>
                            Results can be filtered using additional constraints, including properties of the
                            individual or observation that limit or change which identifying characteristiscs
                            can be used.
                        </p>

                        <details>
                            <summary>Filter by properties of the individual or observation</summary>
                            <div>
                                <b>Life stage:</b>
                                <input type="checkbox" name="scope" value="adults" id="scope_adults">
                                <label for="scope_adults">Adult</label>
                                <input type="checkbox" name="scope" value="subimagos" id="scope_subimagos">
                                <label for="scope_subimagos">Subimago</label>
                                <input type="checkbox" name="scope" value="pupae" id="scope_pupae">
                                <label for="scope_pupae">Pupa</label>
                                <input type="checkbox" name="scope" value="nymphs" id="scope_nymphs">
                                <label for="scope_nymphs">Nymph</label>
                                <input type="checkbox" name="scope" value="larvae" id="scope_larvae">
                                <label for="scope_larvae">Larva</label>
                                <input type="checkbox" name="scope" value="juvenile" id="scope_juvenile">
                                <label for="scope_juvenile">Juvenile</label>
                                <input type="checkbox" name="scope" value="eggs" id="scope_eggs">
                                <label for="scope_eggs">Egg</label>
                            </div>

                            <div>
                                <b>Sex:</b>
                                <input type="checkbox" name="scope" value="females" id="scope_females">
                                <label for="scope_females">Female</label>
                                <input type="checkbox" name="scope" value="males" id="scope_males">
                                <label for="scope_males">Male</label>
                            </div>

                            <div>
                                <b>Caste:</b>
                                <input type="checkbox" name="scope" value="queens" id="scope_queens">
                                <label for="scope_queens">Queen</label>
                                <input type="checkbox" name="scope" value="workers" id="scope_workers">
                                <label for="scope_workers">Worker</label>
                                <input type="checkbox" name="scope" value="soldiers" id="scope_soldiers">
                                <label for="scope_soldiers">Soldier</label>
                                <input type="checkbox" name="scope" value="alatae" id="scope_alatae">
                                <label for="scope_alatae">Alata</label>
                                <input type="checkbox" name="scope" value="apterae" id="scope_apterae">
                                <label for="scope_apterae">Aptera</label>
                                <input type="checkbox" name="scope" value="viviparae" id="scope_viviparae">
                                <label for="scope_viviparae">Vivipara</label>
                            </div>

                            <div>
                                <b>Evidence:</b>
                                <input type="checkbox" name="scope" value="nests" id="scope_nests">
                                <label for="scope_nests">Nest</label>
                                <input type="checkbox" name="scope" value="galls" id="scope_galls">
                                <label for="scope_galls">Gall</label>
                                <input type="checkbox" name="scope" value="puparia" id="scope_puparia">
                                <label for="scope_puparia">Puparium</label>
                                <input type="checkbox" name="scope" value="eggcases" id="scope_eggcases">
                                <label for="scope_eggcases">Eggcase</label>
                                <input type="checkbox" name="scope" value="bones" id="scope_bones">
                                <label for="scope_bones">Bone</label>
                            </div>
                        </details>
                    </fieldset>

                    <button type="submit">Search</button>
                </form>

                <p>
                    <a href="#" onclick="license_info.showModal()">Data license</a>
                </p>
            </div>

            <div id="results_wrapper">
                <p>
                    <label for="results_sort">Sort by:</label>
                    <select id="results_sort">
                        <option value="_score">All</option>
                        <option value="_score_applicability">Applicability</option>
                        <option value="_score_usability">Usability</option>
                        <option value="_score_recency">Recency</option>
                    </select>
                </p>

                <div id="results">
                    <div id="results_message">No results</div>
                </div>
            </div>
        </main>

        <dialog id="dialog_result_score">
            <h3>Search result score</h3>

            <table>
                <tr>
                    <th>Relevance</th>
                    <td>Taxonomic and geographic applicability</td>
                    <td id="score_applicability"></td>
                </tr>
                <tr>
                    <th>Usability</th>
                    <td>Availability and how well it can distinguish taxa</td>
                    <td id="score_usability"></td>
                </tr>
                <tr>
                    <th>Recency</th>
                    <td>Recency of publication</td>
                    <td id="score_recency"></td>
                </tr>
            </table>

            <section id="dialog_taxonomic_coverage">
                <h4>Taxonomic coverage</h4>

                <p>
                    This resource includes <span id="species_count"></span> of the expected <span id="species_total"></span> species,
                    meaning <span id="species_ratio"></span>.
                </p>

                <p id="observation_ratio_text">
                    Scaled by observations, this covers <span id="observation_ratio"></span> of observations.
                </p>

                <div id="species_flags">
                </div>

                <details>
                    <summary>Matching taxa</summary>
                    <ol id="matching_taxa">
                    </ol>
                </details>

                <details>
                    <summary>Missing taxa</summary>
                    <ol id="missing_taxa">
                    </ol>
                </details>
            </section>

            <br>

            <form method="dialog">
                <button>Close</button>
            </form>
        </dialog>

        <dialog>
            <h3>Different editions/versions</h3>

            <div id="results_versions">
            </div>

            <form method="dialog">
                <button>Close</button>
            </form>
        </dialog>

        <dialog id="license_info">
            <h3>Data license</h3>

            <ul>
                <li>
                    Search results, including the coverage, and checklists from the catalog are
                    <a href="https://github.com/identification-resources/catalog/blob/main/LICENSE">licensed under CC0 1.0</a>.
                </li>
                <li>
                    Checklists generated from GBIF occurrences use the GBIF API and data licensed under CC-BY-NC 4.0.
                </li>
                <li>
                    Reverse geocoding (finding places and countries associated with the given coordinates) use APIs
                    from <a href="http://wikidata.org/">Wikidata</a> and <a href="https://www.inaturalist.org/">iNaturalist</a>.
                </li>
            </ul>

            <form method="dialog">
                <button>Close</button>
            </form>
        </dialog>

        <script src="/assets/js/shared.js" charset="utf-8"></script>
        <script src="app.js" charset="utf-8"></script>
    </body>
</html>
